<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title> - Documentation</title>

    <script src="scripts/prettify/prettify.js"></script>
    <script src="scripts/prettify/lang-css.js"></script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="https://code.ionicframework.com/ionicons/2.0.1/css/ionicons.min.css">
    <link type="text/css" rel="stylesheet" href="styles/prettify-tomorrow.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc-default.css">
</head>
<body>

<input type="checkbox" id="nav-trigger" class="nav-trigger" />
<label for="nav-trigger" class="navicon-button x">
  <div class="navicon"></div>
</label>

<label for="nav-trigger" class="overlay"></label>

<nav>
    <h2><a href="/index.html">Stable</a><a href="/indev/index.html">Indev</a></h2><h3>Pages</h3><ul><li><a href="tutorial-FrontPage.html">Home</a></li><li><a href="tutorial-StartingInV3.html">Starting a bot in 3.0.0</a></li><li><a href="tutorial-UsingBotStorage.html">Using bot-specific storage</a></li><li><a href="tutorial-UsingGuildStorage.html">Using guild-specific storage</a></li></ul><h3>Classes</h3><ul><li><a href="Client.html">Client</a></li><li><a href="ClientStorage.html">ClientStorage</a></li><li><a href="Command.html">Command</a></li><li><a href="CommandRegistry.html">CommandRegistry</a></li><li><a href="GuildSettings.html">GuildSettings</a></li><li><a href="GuildStorage.html">GuildStorage</a></li><li><a href="JSONProvider.html">JSONProvider</a></li><li><a href="KeyedStorage.html">KeyedStorage</a></li><li><a href="Logger.html">Logger</a></li><li><a href="RateLimit.html">RateLimit</a></li><li><a href="RateLimiter.html">RateLimiter</a></li><li><a href="StorageProvider.html">StorageProvider</a></li></ul><h3>Interfaces</h3><ul><li><a href="IStorageProvider.html">IStorageProvider</a></li></ul><h3>Mixins</h3><ul><li><a href="Guild.html">Guild</a></li><li><a href="Message.html">Message</a></li></ul><h3>Modules</h3><ul><li><a href="module-CommandDecorators.html">CommandDecorators</a></li><li><a href="module-Middleware.html">Middleware</a></li><li><a href="module-Time.html">Time</a></li><li><a href="module-Util.html">Util</a></li></ul><h3>Decorators</h3><ul><li><a href="global.html#logger">logger</a></li></ul><h3>TypeDefs</h3><ul><li><a href="global.html#ArgOpts">ArgOpts</a></li><li><a href="global.html#BaseCommandName">BaseCommandName</a></li><li><a href="global.html#CommandInfo">CommandInfo</a></li><li><a href="global.html#DefaultGuildSettings">DefaultGuildSettings</a></li><li><a href="global.html#Difference">Difference</a></li><li><a href="global.html#ExpectArgType">ExpectArgType</a></li><li><a href="global.html#LogLevel">LogLevel</a></li><li><a href="global.html#MiddlewareFunction">MiddlewareFunction</a></li><li><a href="global.html#ResolveArgType">ResolveArgType</a></li><li><a href="global.html#StorageProviderConstructor">StorageProviderConstructor</a></li><li><a href="global.html#Tuple">Tuple</a></li><li><a href="global.html#YAMDBFOptions">YAMDBFOptions</a></li></ul><h3>Externals</h3><ul><li><a href="external-Client.html">Client</a></li><li><a href="external-ClientOptions.html">ClientOptions</a></li><li><a href="external-Collection.html">Collection</a></li><li><a href="external-Guild.html">Guild</a></li><li><a href="external-Message.html">Message</a></li><li><a href="external-PermissionResolvable.html">PermissionResolvable</a></li><li><a href="external-User.html">User</a></li></ul>
</nav>

<div id="main">
    

    <section>

<header>
    

    <!-- <h2>Starting a bot in 3.0.0</h2> -->
</header>

<article>
    <h2>Starting a bot in YAMDBF 3.0.0</h2><p>YAMDBF 3.0.0 comes with a handful of breaking changes, the first of which is fairly important and affects how you start up your bot.
When a YAMDBF Client instance is first created, commands will be synchronously loaded. After that is finished the <code>start()</code> method
may be executed. The first thing you should note is that <code>ready</code> is no longer the event you will want to subscribe to for
determining when the YAMDBF Client is ready for use. The new event is <code>clientReady</code></p>
<p>After <code>start()</code> is called the Client will go through the Discord.js client login process and register some event
listeners for some internal things. During this time the Client <code>init()</code> method will be called. This is where storages --
<code>ClientStorage</code> and all <code>GuildStorage</code> instances -- will be created and linked with the current storage provider. After
this process completes the <code>waiting</code> event will be emitted.</p>
<blockquote>
<p>Because of how storages are loaded asynchronously after <code>start()</code> is called it is no longer possible to interact with
default settings until after storages have been loaded, meaning guilds will have their default settings applied before
you will have the chance to set them when guild setting storage is generated for the first time. This means it becomes
necessary to either completely remove guild settings and allow them to regenerate after changing default settings the
first time the Client is started, or to iterate over guild storages and apply any changes one time to bring them up to date
with the defaults. This of course only needs to be done if you are trying to set a default setting the first time your client
is run and fresh storages are generated. After that the default settings will be properly applied to new guilds and their
settings.</p>
</blockquote>
<p>After the <code>waiting</code> event is fired is when you have the opportunity to set up anything that needs it before the Client
is ready to operate. When you have finished with whatever you need to do after <code>waiting</code> you must use <code>&lt;Client&gt;.emit('finished');</code>
to tell the Client you have finished setting up. After this <code>clientReady</code> will be emitted and the Client will be ready for use.</p>
<p>I'll end this with a barebones example of starting a bot with the new startup flow and a simple example of what
setting a default setting will look like:</p>
<pre class="prettyprint source"><code>const { Client } = require('yamdbf');
const config = require('./config.json');

const client = new Client({
    name: 'YAMDBFBot',
    commandsDir: './commands',
    token: config.token,
    config: config
}).start();

client.on('waiting', async () =>
{
    await client.setDefaultSetting('prefix', '.');
    client.emit('finished');
});</code></pre>
</article>

</section>

</div>

<br class="clear">

<footer>
	<div align="right">
    	<a href="https://github.com/jsdoc3/jsdoc">JSDoc3.5.0-dev</a> | Minami
	</div>
</footer>

<script>prettyPrint();</script>
<script src="scripts/linenumber.js"></script>
</body>
</html>